services:
  idrac6:
    # Build from the Dockerfile in this cloned repo
    build:
      context: .
      dockerfile: Dockerfile

    # Local tag for the image that gets built
    image: idrac6-local:dev
    container_name: idrac6

    ports:
      - "5800:5800"  # noVNC web UI
      - "5700:5900"  # raw VNC (optional)

    # Put your secrets in ./.env (not committed)
    env_file:
      - .env

    # Keep these as env var names expected by the container
    environment:
      IDRAC_HOST: ${IDRAC_HOST}
      IDRAC_USER: ${IDRAC_USER}
      IDRAC_PASSWORD: ${IDRAC_PASSWORD}
      # Optional (uncomment if you want to mount an ISO from ./vmedia)
      # VIRTUAL_ISO: ${VIRTUAL_ISO}

    # Local folders inside this repo (create them if you need them)
    volumes:
      - ./app:/app
      - ./vmedia:/vmedia
      - ./screenshots:/screenshots

    restart: unless-stopped
